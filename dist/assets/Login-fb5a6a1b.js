import{u as y,r as t,A as b,j as e,$ as w,a0 as N,a as L}from"./index-55cceeff.js";import{u as f}from"./http-hook-dc2aacf9.js";import{F as C}from"./index.esm-376e65ce.js";import{L as k}from"./LoadingSpinnerPuff-b9c0cf14.js";import{F as o}from"./Form-e975255d.js";import"./iconBase-4260ecf4.js";import"./ElementChildren-9bc860c0.js";const I=({styles:a})=>{const d=y(),r=t.useContext(b),{isLoading:h,error:u,sendRequest:p,clearError:g}=f(),[x,s]=t.useState(!1),[i,S]=t.useState({username:"",password:"",subDomain:window.location.hostname.split(".")[0]}),j=m=>{const{name:l,value:n}=m.target;s(!1),S(c=>({...c,[l]:n}))},v=async m=>{var l;m.preventDefault(),console.log("Input values:",i);try{const n=await p("https://upskill-develop.herokuapp.com/api/student/login","POST",JSON.stringify(i),{"Content-Type":"application/json"}),c=N(n.token);r.login(c.studentId,n.token),((l=c.goal)==null?void 0:l.length)>1?d("/home"):d("/personalinformation")}catch(n){console.log(n),s(!0)}};return e.jsx("div",{className:"login-background appear",style:a,children:e.jsx("div",{className:"login-body appear",children:e.jsxs("div",{className:"login-card",children:[e.jsx("img",{src:w,className:"login-logo"}),e.jsx("div",{style:{position:"relative",marginTop:"26px"},children:e.jsx("h1",{children:" Sign in"})}),e.jsx("div",{className:"login-form",children:e.jsxs(o,{onSubmit:v,children:[e.jsx("div",{children:e.jsxs(o.Group,{controlId:"formBasicEmail",children:[e.jsx(o.Label,{children:e.jsx("h2",{children:"User name"})}),e.jsx(o.Control,{type:"test",name:"username",value:i.username,onChange:j,placeholder:"User name",required:!0})]})}),e.jsx("div",{children:e.jsxs(o.Group,{controlId:"formBasicPhone",children:[e.jsx(o.Label,{children:e.jsx("h2",{children:"Password"})}),e.jsx(o.Control,{type:"password",name:"password",value:i.password,onChange:j,placeholder:"Enter your password",required:!0})]})}),e.jsx("div",{className:"login-btn-submit",children:e.jsx("button",{type:"submit",children:e.jsx("h2",{children:"Login"})})})]})}),h&&e.jsx(k,{color:"#F37103"}),x&&e.jsxs("div",{className:"login-failed",children:[" ",e.jsx(C,{size:24})," ",e.jsx("p",{className:"p-h4",children:"User name or Password is not correct!"})]})]})})})},D=()=>{const{isLoading:a,error:d,sendRequest:r,clearError:h}=f(),[u,p]=t.useState({});return t.useEffect(()=>{const g=window.location.hostname.split(".")[0];(async()=>{try{const s=await r("https://upskill-develop.herokuapp.com/api/school/query","POST",JSON.stringify({subDomain:g}),{"Content-Type":"application/json"});p({backgroundImage:`url(${s==null?void 0:s.data[0].backgroundLogin})`}),localStorage.setItem("school",JSON.stringify(s==null?void 0:s.data[0])),console.log(s)}catch(s){console.log(s)}})()},[r]),e.jsxs(e.Fragment,{children:[a&&e.jsx(L,{}),!a&&u&&e.jsx(I,{styles:u})]})};export{D as default};
