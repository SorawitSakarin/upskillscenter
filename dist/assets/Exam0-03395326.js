import{r,u as P,j as t,M as j,A as D,a as T}from"./index-55cceeff.js";import{u as L}from"./http-hook-dc2aacf9.js";import{S as I}from"./SideBar-69560abc.js";/* empty css             */import{u as M,c as R}from"./Default-1-c8c4daa2.js";import{l as B,m as $,b as H}from"./Default-5-d87e80c7.js";const A=({exam:s})=>{const[l,c]=r.useState(!1),[d,x]=r.useState(!1),n=P(),g=(b,h,f)=>{h?b?c(!0):n(`/posttest/${f}`):x(!0)},p=()=>{c(!1)},m=()=>{x(!1)},u=Math.floor(s.time/60);return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:`exam-card ${s.pretestStatus?"exam-card-active":""}`,onClick:()=>g(s.status,s.pretestStatus,s.id),children:[t.jsx("div",{children:t.jsx("img",{src:s.subjectBanner,alt:"topic banner",style:{borderTopLeftRadius:"16px",borderBottomLeftRadius:"16px"}})}),t.jsxs("div",{className:"exam-card-left",children:[t.jsxs("div",{children:[t.jsx("p",{className:"p-h5",children:s.tag.split(",").splice(0,2).join(", ")}),t.jsx("h2",{children:s.title})]}),t.jsxs("p",{className:"p-h4",children:[u," minutes"]})]}),t.jsxs("div",{className:"exam-card-right",children:[!s.status&&t.jsx("img",{src:M,alt:"check logo",width:24,style:{opacity:"0.4"}}),s.status&&t.jsx("img",{src:R,alt:"check logo",width:24})]})]}),s.status&&t.jsx(j,{show:l,onHide:p,centered:!0,children:t.jsx(j.Body,{children:t.jsxs("div",{style:{padding:"24px",flexDirection:"column",display:"flex",justifyContent:"center",alignItems:"center",gap:"16px"},children:[t.jsx("h1",{children:"Notice"}),t.jsxs("p",{className:"p-h2",children:["Congratulation! You have already done this exam.",t.jsx("br",{}),"You can retake the exam as many times as you want, but the score is only collected the first time."," "]}),t.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:"24px"},children:[t.jsx("button",{style:{padding:"10px",borderRadius:"8px",border:"1.4px solid black"},onClick:p,children:"Back"}),t.jsx("button",{style:{padding:"10px",borderRadius:"8px",backgroundColor:"#244d11",color:"white",border:"1.4px solid black"},onClick:()=>n(`/posttest/${s.id}`),children:"Do it again!"}),t.jsx("button",{style:{padding:"10px",backgroundColor:"#F37103",color:"white",borderRadius:"8px"},onClick:()=>n(`/result?type=posttest&testId=${s.id}`),children:"Answer Sheet"})]})]})})}),t.jsx(j,{show:d,onHide:m,centered:!0,children:t.jsx(j.Body,{children:t.jsxs("div",{style:{padding:"24px",flexDirection:"column",display:"flex",justifyContent:"center",alignItems:"center",gap:"16px"},children:[t.jsx("h1",{children:"Notice"}),t.jsxs("p",{className:"p-h2",children:["You must first complete a pretest in this topic before taking the exam.",t.jsx("br",{}),"Go to do the pretest exam."]}),t.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:"24px"},children:[t.jsx("button",{style:{padding:"10px",borderRadius:"8px",border:"1.4px solid black"},onClick:m,children:"Back"}),t.jsx("button",{style:{padding:"10px",backgroundColor:"#F37103",color:"white",borderRadius:"8px"},onClick:()=>n(`/pretest/${s.preTestId}`),children:"Let's Go to the test!"})]})]})})})]})},F=({data:s})=>s?t.jsx("div",{className:"exam-list",children:s.map((l,c)=>t.jsx(A,{exam:l},c))}):t.jsx("div",{className:"no-exam-list",children:t.jsx("h1",{children:"Exam is coming soon..."})}),Y=({pretests:s,posttests:l})=>{const[c,d]=r.useState("TOEIC"),[x,n]=r.useState(!0);return t.jsxs("div",{className:"exam-body ",children:[t.jsx(I,{setSelectedTopic:d,headerTitle:"Exam",setTagCard:n,subjects:s}),t.jsxs("div",{className:"exam-body-right appear",children:[t.jsx("h1",{children:c}),t.jsx(F,{data:l[c]})]})]})},Q=()=>{const s=r.useContext(D),{isLoading:l,error:c,sendRequest:d,clearError:x}=L(),[n,g]=r.useState(),[p,m]=r.useState(),[u,b]=r.useState(),[h,f]=r.useState(),N=[{icon:B,name:"English",topics:[]},{icon:$,name:"Math",topics:[]},{icon:H,name:"Computer Science",topics:["Programing","Streaming"]}];return r.useEffect(()=>{const y=async()=>{try{const e=await d("https://upskill-develop.herokuapp.com/api/pretest");if(e){const i=window.location.hostname.split(".")[0],o=e.data.filter(a=>a.subDomain==="all"||a.subDomain.split(",").includes(i));g(o)}}catch(e){console.log(e)}};(async()=>{try{const e=await d("https://upskill-develop.herokuapp.com/api/posttest");if(e){const i=window.location.hostname.split(".")[0],o=e.data.filter(a=>a.subDomain==="all"||a.subDomain.split(",").includes(i));m(o)}}catch(e){console.log(e)}})(),y()},[d]),r.useEffect(()=>{if(!n||!p)return;let y=n.reduce((e,i)=>{let o=e.find(a=>a.name===i.subject);return o?o.topics.push(i.title):e.push({name:i.subject,topics:[i.title]}),e},N),k=p.reduce((e,i)=>{var v,w;const o=n.find(E=>E.id===i.preTestId),a=o?o.title:void 0,S=o?(v=o.studentList)==null?void 0:v.split(",").includes(s.userId.toString()):!1,C=o?(w=i.studentList)==null?void 0:w.split(",").includes(s.userId.toString()):!1;return e[a]?e[a].push({...i,status:C,pretestStatus:S,subjectBanner:o==null?void 0:o.banner}):e[a]=[{...i,status:C,pretestStatus:S,subjectBanner:o==null?void 0:o.banner}],e},{});console.log(k),f(k),b(y)},[n,p]),t.jsxs("div",{className:"exam-body ",children:[(l||!u||!h)&&t.jsx(T,{}),!l&&u&&h&&t.jsx(Y,{pretests:u,posttests:h})]})};export{Q as default};
